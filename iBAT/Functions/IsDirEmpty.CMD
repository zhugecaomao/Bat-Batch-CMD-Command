:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:IsDirEmpty %dir%
::
:: 作者：Ritchie Lawrence, 2003-09-22. 版本 1.0
::
:: 功能：如果指定目录为空，errorlevel 被设置为 0，如果目录非空或不存在，
::       errorlevel 被设置为一个非 0 值。
::       适用于 NT4/2000/XP/2003.
:: 
:: 参数：%1 待检测的目录名称（传值调用）
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
setlocal ENABLEEXTENSIONS & dir/ad %1 >nul 2>nul || (endlocal & goto :EOF)
set i=0 & for /f %%a in ('dir %1/a/b 2^>nul') do set/a "i+=1"
md;2>nul & (if %i%==0 ver>nul) & endlocal & goto :EOF
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::