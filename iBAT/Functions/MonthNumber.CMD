:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:MonthNumber %month% mm
::
:: 作者：Ritchie Lawrence, 2003-05-14. 版本 1.0
::
:: 功能：通过月份名称来获取该月是当年的第几个月。
::       返回值是 01 到12，如果没有匹配项，将返回空。
::       适用于 NT4/2000/XP/2003.
:: 
:: 参数：%1 待转换的月份名称，范围是一月到十二月（传值调用）
::       %2 该变量用于接收此月是当年的第几个月（引用调用）
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
setlocal ENABLEEXTENSIONS & set i=0
for %%a in (一月 二月 三月 四月 五月 六月 七月 八月 九月 十月 十一月^ 十二月) do (
  set /a i+=1 & echo/%1|findstr /i /b "%%a" >nul && call set mm=%%i%%)
(if 1%mm% LSS 110 set mm=0%mm%) & endlocal&set %2=%mm%&goto :EOF
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::   