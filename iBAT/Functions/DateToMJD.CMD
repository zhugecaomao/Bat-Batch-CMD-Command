:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:DateToMJD %yy% %mm% %dd% MJD
::
:: 作者：Ritchie Lawrence, 2002-06-15. 版本 1.0
::
:: 功能：把一个协调世界时（UTC）日期转换为修正儒略日（MJD）
::       参考日期（第零天）是 1858 年 11 月 17 日
::       适用于 NT4/2000/XP/2003.
:: 
:: 参数：%1 待转换的年，两位或者四位（传值调用）
::       %2 待转换的月，可以以零开头（传值调用）
::       %3 待转换的日，可以以零开头（传值调用）
::       %4 该变量用于接收修正儒略日（引用调用）
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
setlocal ENABLEEXTENSIONS
set yy=%1&set mm=%2&set dd=%3
if 1%yy% LSS 200 if 1%yy% LSS 170 (set yy=20%yy%) else (set yy=19%yy%)
set /a dd=100%dd%%%100,mm=100%mm%%%100
set /a z=14-mm,z/=12,y=yy+4800-z,m=mm+12*z-3,j=153*m+2
set /a j=j/5+dd+y*365+y/4-y/100+y/400-2432046
endlocal&set %4=%j%&goto :EOF
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
　  