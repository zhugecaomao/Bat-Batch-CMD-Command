:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:DayNumber %Weekday% dow
::
:: 作者：Ritchie Lawrence, 2003-05-14. 版本 1.0
::
:: 功能：通过星期名称获取该天是星期的第几天。如果没有匹配值，则返回空。
::       适用于 NT4/2000/XP/2003.
:: 
:: 参数：%1 待转换的星期名称（传值调用）
::       %2 该变量用于接收该日是星期的第几天（引用调用）
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
setlocal ENABLEEXTENSIONS & set i=0
for %%a in (星期一 星期二 星期三 星期四 星期五 星期六 星期日) do (
  set /a i+=1 & echo/%1|findstr /i /b "%%a" >nul && call set dow=%%i%%)
endlocal&set %2=%dow%&goto :EOF
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::  