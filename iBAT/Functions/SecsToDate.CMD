:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:SecsToDate %secs% yy mm dd hh nn ss
::
:: 作者：Ritchie Lawrence, updated 2002-07-24. 版本 1.1
::
:: Func: 把自从 1970-01-01 00:00:00 所经过的秒钟数转换为日期。
::       适用于 NT4/2000/XP/2003.
:: 
:: 参数：%1 所经过的秒钟数（传值调用）
::       %2 该变量用于接收年，四位（引用调用）
::       %3 该变量用于接收月，两位，范围是 01 到 12（引用调用）
::       %4 该变量用于接收日，两位，范围是 01 到 31（引用调用）
::       %5 该变量用于接收小时，两位，范围是 00 到 23（引用调用）
::       %6 该变量用于接收分钟，两位，范围是 00 到 59（引用调用）
::       %7 该变量用于接收秒钟，两位，范围是 00 到 59（引用调用）
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
setlocal ENABLEEXTENSIONS
set /a i=%1,ss=i%%60,i/=60,nn=i%%60,i/=60,hh=i%%24,dd=i/24,i/=24
set /a a=i+2472632,b=4*a+3,b/=146097,c=-b*146097,c/=4,c+=a
set /a d=4*c+3,d/=1461,e=-1461*d,e/=4,e+=c,m=5*e+2,m/=153,dd=153*m+2,dd/=5
set /a dd=-dd+e+1,mm=-m/10,mm*=12,mm+=m+3,yy=b*100+d-4800+m/10
(if %mm% LSS 10 set mm=0%mm%)&(if %dd% LSS 10 set dd=0%dd%)
(if %hh% LSS 10 set hh=0%hh%)&(if %nn% LSS 10 set nn=0%nn%)
if %ss% LSS 10 set ss=0%ss% 
endlocal&set %7=%ss%&set %6=%nn%&set %5=%hh%&^
set %4=%dd%&set %3=%mm%&set %2=%yy%&goto :EOF
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::  