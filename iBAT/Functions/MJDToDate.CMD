:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:MJDToDate %MJD% yy mm dd
::
:: 作者：Ritchie Lawrence, 2002-06-15. 版本 1.1
::
:: 功能：把一个修正儒略日（MJD）日期转换为协调世界时（UTC）
::       参考日期（第零天）是 1858 年 11 月 17 日
::       适用于 NT4/2000/XP/2003.
:: 
:: Args: %1 待转换修正儒略日（传值调用）
::       %2 待转换的年，四位（引用调用）
::       %3 待转换的月，两位，范围是 01 到 12（引用调用）
::       %4 待转换的日，两位，范围是 01 到 31（引用调用）
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
setlocal ENABLEEXTENSIONS
set /a a=%1+2432045,b=4*a+3,b/=146097,c=-b*146097,c/=4,c+=a
set /a d=4*c+3,d/=1461,e=-1461*d,e/=4,e+=c,m=5*e+2,m/=153,dd=153*m+2,dd/=5
set /a dd=-dd+e+1,mm=-m/10,mm*=12,mm+=m+3,yy=b*100+d-4800+m/10
(if %mm% LSS 10 set mm=0%mm%)&(if %dd% LSS 10 set dd=0%dd%)
endlocal&set %2=%yy%&set %3=%mm%&set %4=%dd%&goto :EOF
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::